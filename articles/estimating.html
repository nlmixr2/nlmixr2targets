<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nlmixr2targets">
<title>Estimating nlmixr2 models with 'nlmixr2targets' â€¢ nlmixr2targets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating nlmixr2 models with 'nlmixr2targets'">
<meta property="og:description" content="nlmixr2targets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlmixr2targets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/estimating.html">Estimating nlmixr2 models with 'nlmixr2targets'</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimating nlmixr2 models with 'nlmixr2targets'</h1>
            
      
      
      <div class="d-none name"><code>estimating.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2targets/">nlmixr2targets</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-nlmixr2targets">Introduction to <code>nlmixr2targets</code><a class="anchor" aria-label="anchor" href="#introduction-to-nlmixr2targets"></a>
</h2>
<p>The <code>nlmixr2targets</code> improves reproducibility by ensuring
that your model is up-to-date with your data, and it speeds your
workflow using the <code>targets</code> package to only run models when
the model or data have changed.</p>
<p>There are two main functions that are used within the package:</p>
<ul>
<li>
<code><a href="../reference/tar_nlmixr.html">tar_nlmixr()</a></code> which runs a single model, and</li>
<li>
<code><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel()</a></code> which runs multiple models for
a single dataset.</li>
</ul>
<p>Using <code>nlmixr2targets</code> requires the use of the
<code>targets</code> package. To learn about the <code>targets</code>
package, see (<a href="https://docs.ropensci.org/targets/" class="external-link uri">https://docs.ropensci.org/targets/</a>)[the targets
website].</p>
</div>
<div class="section level2">
<h2 id="running-one-model-with-one-dataset-tar_nlmixr">Running one model with one dataset (<code>tar_nlmixr()</code>)<a class="anchor" aria-label="anchor" href="#running-one-model-with-one-dataset-tar_nlmixr"></a>
</h2>
<p>The <code><a href="../reference/tar_nlmixr.html">tar_nlmixr()</a></code> function allows you to estimate one
model with one dataset. It will generate three targets: a simplified
version of the model, a minimal version of the dataset, and the
estimation step.</p>
<p>The simplified version of the model removes parts that are less
reproducible but changes none of the model intent. (Advanced
information: The parts that are removed are that the source references
and the model name. Also, the model is modified at this step for setting
initial values as described in the previous section of this
vignette.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/" class="external-link">tarchetypes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2targets/">nlmixr2targets</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.008</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of clearance"</span><span class="op">)</span></span>
<span>    <span class="va">lvc</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of volume of distribution"</span><span class="op">)</span></span>
<span>    <span class="va">etalcl</span> <span class="op">+</span> <span class="va">etalvc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                        <span class="fl">0.01</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">cpaddSd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"residual variability"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lcl</span> <span class="op">+</span> <span class="va">etalcl</span><span class="op">)</span></span>
<span>    <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvc</span> <span class="op">+</span> <span class="va">etalvc</span><span class="op">)</span></span>
<span>    <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">cl</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">central</span></span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="va">central</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">cpaddSd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plan_model</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">tar_plan</span><span class="op">(</span></span>
<span>    myData <span class="op">=</span> <span class="fu">nlmixr2data</span><span class="fu">::</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2data/reference/pheno_sd.html" class="external-link">pheno_sd</a></span>,</span>
<span>    <span class="fu"><a href="../reference/tar_nlmixr.html">tar_nlmixr</a></span><span class="op">(</span></span>
<span>      <span class="va">model_pheno</span>,</span>
<span>      object <span class="op">=</span> <span class="va">pheno</span>,</span>
<span>      data <span class="op">=</span> <span class="va">myData</span>,</span>
<span>      est <span class="op">=</span> <span class="st">"saem"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">plan_model</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-multiple-models-with-one-dataset-tar_nlmixr_multimodel">Running multiple models with one dataset
(<code>tar_nlmixr_multimodel()</code>)<a class="anchor" aria-label="anchor" href="#running-multiple-models-with-one-dataset-tar_nlmixr_multimodel"></a>
</h2>
<p>A common use case is to generate multiple models using a single
dataset and estimation method. <code><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel()</a></code>
allows the generation of a named list of models to allow subsequent
analysis of all models.</p>
<p>Internally, <code><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel()</a></code> passes all the
models to <code><a href="../reference/tar_nlmixr.html">tar_nlmixr()</a></code> so that the data set simplification
and equivalent steps run once per model, and not model is run more often
than required for dataset or model changes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/" class="external-link">tarchetypes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2targets/">nlmixr2targets</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.008</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of clearance"</span><span class="op">)</span></span>
<span>    <span class="va">lvc</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of volume of distribution"</span><span class="op">)</span></span>
<span>    <span class="va">etalcl</span> <span class="op">+</span> <span class="va">etalvc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                        <span class="fl">0.01</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">cpaddSd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"residual variability"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lcl</span> <span class="op">+</span> <span class="va">etalcl</span><span class="op">)</span></span>
<span>    <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvc</span> <span class="op">+</span> <span class="va">etalvc</span><span class="op">)</span></span>
<span>    <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">cl</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">central</span></span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="va">central</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">cpaddSd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pheno2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.008</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of clearance"</span><span class="op">)</span></span>
<span>    <span class="va">lvc</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of volume of distribution"</span><span class="op">)</span></span>
<span>    <span class="va">etalcl</span> <span class="op">+</span> <span class="va">etalvc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,</span>
<span>                        <span class="fl">0.01</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">cpaddSd</span> <span class="op">&lt;-</span> <span class="fl">3.0</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"residual variability"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lcl</span> <span class="op">+</span> <span class="va">etalcl</span><span class="op">)</span></span>
<span>    <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvc</span> <span class="op">+</span> <span class="va">etalvc</span><span class="op">)</span></span>
<span>    <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">cl</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">central</span></span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="va">central</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">cpaddSd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plan_model</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel</a></span><span class="op">(</span></span>
<span>    <span class="va">all_models</span>,</span>
<span>    data <span class="op">=</span> <span class="fu">nlmixr2data</span><span class="fu">::</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2data/reference/pheno_sd.html" class="external-link">pheno_sd</a></span>,</span>
<span>    est <span class="op">=</span> <span class="st">"saem"</span>,</span>
<span>    <span class="st">"Base model; additive residual error = 1"</span> <span class="op">=</span> <span class="va">pheno</span>,</span>
<span>    <span class="st">"Base model; additive residual error = 3"</span> <span class="op">=</span> <span class="va">pheno2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plan_report</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">tar_plan</span><span class="op">(</span></span>
<span>    <span class="co"># Determine the AIC for all tested models</span></span>
<span>    aic_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">all_models</span>, FUN <span class="op">=</span> <span class="va">AIC</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">plan_model</span>,</span>
<span>  <span class="va">plan_report</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="model-piping-for-multiple-models-estimated-with-one-dataset">Model piping for multiple models estimated with one dataset<a class="anchor" aria-label="anchor" href="#model-piping-for-multiple-models-estimated-with-one-dataset"></a>
</h3>
<p>Model piping for <code>nlmixr2</code> models (see
<code><a href="https://nlmixr2.github.io/nlmixr2/articles/modelPiping.html" class="external-link">vignette("modelPiping", package = "nlmixr2")</a></code>) is possible
within the multiple models being estimated with
<code><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel()</a></code>. It simplifies examples like the
one above so that you can focus on the model content and avoid rewriting
models, as with all <code>nlmixr2</code> model piping.</p>
<p>To use model piping, simply refer to the model by its name like a
named list. Behind the scenes, <code>nlmixr2targets</code> will work out
the dependencies between the models and only rerun the dependent model
if it or the dependent model changes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/" class="external-link">tarchetypes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2targets/">nlmixr2targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.org/" class="external-link">nlmixr2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ini</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.008</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of clearance"</span><span class="op">)</span></span>
<span>    <span class="va">lvc</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"Typical value of volume of distribution"</span><span class="op">)</span></span>
<span>    <span class="va">etalcl</span> <span class="op">+</span> <span class="va">etalvc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                        <span class="fl">0.01</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">cpaddSd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>; <span class="fu">label</span><span class="op">(</span><span class="st">"residual variability"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lcl</span> <span class="op">+</span> <span class="va">etalcl</span><span class="op">)</span></span>
<span>    <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lvc</span> <span class="op">+</span> <span class="va">etalvc</span><span class="op">)</span></span>
<span>    <span class="va">kel</span> <span class="op">&lt;-</span> <span class="va">cl</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">kel</span><span class="op">*</span><span class="va">central</span></span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="va">central</span><span class="op">/</span><span class="va">vc</span></span>
<span>    <span class="va">cp</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">cpaddSd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plan_model</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/tar_nlmixr_multimodel.html">tar_nlmixr_multimodel</a></span><span class="op">(</span></span>
<span>    <span class="va">all_models</span>,</span>
<span>    data <span class="op">=</span> <span class="fu">nlmixr2data</span><span class="fu">::</span><span class="va"><a href="https://nlmixr2.github.io/nlmixr2data/reference/pheno_sd.html" class="external-link">pheno_sd</a></span>,</span>
<span>    est <span class="op">=</span> <span class="st">"saem"</span>,</span>
<span>    <span class="st">"Base model; additive residual error = 1"</span> <span class="op">=</span> <span class="va">pheno</span>,</span>
<span>    <span class="st">"Base model; additive residual error = 3"</span> <span class="op">=</span></span>
<span>      <span class="va">all_models</span><span class="op">[[</span><span class="st">"Base model; additive residual error = 1"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">ini</span><span class="op">(</span>cpaddSd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">plan_model</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bill Denney.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
